<html>
  <head>
  </head>
  <body>
    <p id="text">test</p><br>
    <!--<video id="video" width="720" height="560" autoplay muted></video><br>-->
    <img id="video" src="./image.jpg"/>
  </body>
  <!-- Load TensorFlow.js -->
  <script src="https://unpkg.com/@tensorflow/tfjs"></script>
  <!-- Load Posenet -->
  <script src="https://unpkg.com/@tensorflow-models/posenet"></script>
  <script>
    var imageScaleFactor = 0.2;
    var outputStride = 16;
    var flipHorizontal = false;

    var player = document.getElementById('video');
    var txt = document.getElementById('text')

    window.onload = function () {
        startVideo();
    }

    posenet.load().then(function(net){
        //txt.textContent = net.estimateSinglePose(player, imageScaleFactor, flipHorizontal, outputStride)
        return net.estimateSinglePose(player, imageScaleFactor, flipHorizontal, outputStride)
    })
    .then(function(pose){
        //txt.textContent = pose
        txt.textContent = "OK"
    })
    .catch((e) => {
        txt.textContent = e;
    })

    /**カメラを用いたビデオストリーミング**/
    function startVideo() {
        var constraints = {
            audio: true,
            video: {
            width: player.width,
            height: player.height
            }
        };
    
        navigator.mediaDevices.getUserMedia(constraints)
        .then(function(stream) {
            player.srcObject = stream;
            player.onloadedmetadata = function(e) {
            player.play();
            };
        })
        .catch(function(err) {
            console.log(err.name+": "+err.message);
        });
    }
  </script>
</html>